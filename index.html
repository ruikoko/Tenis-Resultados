
<!doctype html>
<html lang="pt">
<head>
  <meta charset="utf-8">
  <title>Resultados de T√©nis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 24px; }
    h1 { margin: 0 0 12px; }
    .bar { display:flex; gap:12px; align-items:center; margin: 12px 0 20px; }
    input, select { padding:6px 8px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 6px 8px; font-size: 14px; }
    th { background: #f5f5f5; position: sticky; top: 0; }
    tr:nth-child(even){ background:#fafafa; }
    .pill { padding:2px 6px; border-radius: 12px; font-size: 12px; }
    .review { background:#fff3cd; border:1px solid #ffe08a; }
    .ok { background:#e7f7ef; border:1px solid #b8ead2; }
    #status { font-size: 13px; color:#555; }
  </style>
</head>
<body>
  <h1>Resultados de T√©nis</h1>

  <div class="bar">
    <label>Filtro torneio:
      <input id="f-torneio" placeholder="ex: Mar del Plata">
    </label>
    <label>Filtro jogador:
      <input id="f-jogador" placeholder="ex: Nicolas">
    </label>
    <span id="status">A carregar‚Ä¶</span>
  </div>

  <table id="tabela">
    <thead>
      <tr>
        <th>Data</th>
        <th>Tour</th>
        <th>N√≠vel</th>
        <th>Torneio</th>
        <th>Local</th>
        <th>Superf√≠cie</th>
        <th>Ronda</th>
        <th>Vencedor</th>
        <th>Derrotado</th>
        <th>Placar</th>
        <th>Revisar</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
  const SRC = 'data/resultados_com_vencedor.json';

  const $tbody = document.querySelector('#tabela tbody');
  const $status = document.getElementById('status');
  const $fTorneio = document.getElementById('f-torneio');
  const $fJogador = document.getElementById('f-jogador');

  let DATA = [];

  function txt(x){ return x == null ? '' : String(x); }

  function render(rows){
    $tbody.innerHTML = '';
    rows.forEach(j => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${txt(j.data)}</td>
        <td>${txt(j.tour)}</td>
        <td>${txt(j['n√≠vel']) || txt(j.nivel) || ''}</td>
        <td>${txt(j.torneio)}</td>
        <td>${txt(j.local)}</td>
        <td>${txt(j['superf√≠cie']) || txt(j.superficie) || ''}</td>
        <td>${txt(j.round || j.rodada)}</td>
        <td>${txt(j.winner)}</td>
        <td>${txt(j.loser)}</td>
        <td>${txt(j.placar || j.score)}</td>
        <td>
          <span class="pill ${j.needs_review ? 'review':'ok'}">
            ${j.needs_review ? 'üîç Rever' : 'OK'}
          </span>
        </td>`;
      $tbody.appendChild(tr);
    });
    $status.textContent = `${rows.length} jogos`;
  }

  function applyFilters(){
    const ft = $fTorneio.value.toLowerCase().trim();
    const fj = $fJogador.value.toLowerCase().trim();
    const out = DATA.filter(j => {
      const okT = !ft || (txt(j.torneio).toLowerCase().includes(ft));
      const okJ = !fj || (txt(j.winner).toLowerCase().includes(fj) || txt(j.loser).toLowerCase().includes(fj));
      return okT && okJ;
    });
    render(out);
  }

  $fTorneio.addEventListener('input', applyFilters);
  $fJogador.addEventListener('input', applyFilters);

  fetch(SRC)
    .then(r => {
      if(!r.ok) throw new Error('N√£o encontrei o ficheiro de dados: ' + SRC);
      return r.json();
    })
    .then(json => { DATA = json; render(DATA); })
    .catch(err => { $status.textContent = err.message; });
  </script>
</body>
</html>
